package app.load.mapreduce

import com.nhaarman.mockitokotlin2.mock
import io.kotest.core.spec.style.StringSpec
import io.kotest.matchers.shouldBe

class CoalescedTest: StringSpec() {
    init {
        "coalesced coalesces" {
            val dumplist = setOf("accessCodeThrottle",
                    "accessCodeVerification",
                    "accessList",
                    "accountVerification",
                    "actionedPayments",
                    "activeAdvanceProcess",
                    "additionalClaimantInformation",
                    "address",
                    "addressDeclaration",
                    "advanceDebtPosition",
                    "advanceDetails",
                    "advanceGroup",
                    "advanceProcessInitialisationFailure",
                    "agent",
                    "agentAction",
                    "agentAssignment",
                    "agentFeedback",
                    "agentGuidance",
                    "agentGuidanceTracking",
                    "agentPrivileges",
                    "agentsInTeam",
                    "agentSupportRoles",
                    "agentTakenTime",
                    "agentThirdPartyReference",
                    "agentToDo",
                    "agentToDoArchive",
                    "agentToDoImport",
                    "agentWorkGroupAllocation",
                    "alternativePaymentArrangement",
                    "apa",
                    "apaPayment",
                    "appointment",
                    "appointmentReminderJobMetadata",
                    "appointmentTypesByJobcentre",
                    "archiveRecord",
                    "assessmentPeriod",
                    "attachmentMetaData",
                    "attachments",
                    "attachmentsData",
                    "attachmentsMetadata",
                    "authentication",
                    "authenticationRequest",
                    "availability",
                    "awardModification",
                    "bankAccountTransactionData",
                    "bankDetails",
                    "bankDetailsDeclaration",
                    "blockedTime",
                    "blockedTimeSlot",
                    "bookedEvidenceOrPsnAppointment",
                    "bulkRentChangeRequest",
                    "calculatedDeductions",
                    "calculateDeductions",
                    "calculation",
                    "calculationParts-archived",
                    "calculationParts-eight",
                    "calculationParts-eighteen",
                    "calculationParts-eleven",
                    "calculationParts-fifteen",
                    "calculationParts-five",
                    "calculationParts-four",
                    "calculationParts-fourteen",
                    "calculationParts-nine",
                    "calculationParts-nineteen",
                    "calculationParts-one",
                    "calculationParts-seven",
                    "calculationParts-seventeen",
                    "calculationParts-six",
                    "calculationParts-sixteen",
                    "calculationParts-ten",
                    "calculationParts-thirteen",
                    "calculationParts-thirty",
                    "calculationParts-thirtyone",
                    "calculationParts-thirtytwo",
                    "calculationParts-three",
                    "calculationParts-twelve",
                    "calculationParts-twenty",
                    "calculationParts-twentyeight",
                    "calculationParts-twentyfive",
                    "calculationParts-twentyfour",
                    "calculationParts-twentynine",
                    "calculationParts-twentyone",
                    "calculationParts-twentyseven",
                    "calculationParts-twentysix",
                    "calculationParts-twentythree",
                    "calculationParts-twentytwo",
                    "calculationParts-two",
                    "calculatorClaim",
                    "capital",
                    "carerCircumstances",
                    "carerDeclaration",
                    "carersAllowance",
                    "carerTimeOff",
                    "caringDeclaration",
                    "caseLoadEvent",
                    "checkAutoCalcPendingData",
                    "childcare",
                    "childcareDeclaration",
                    "childcareTransactionData",
                    "childDeclaration",
                    "childElementEligibility",
                    "childrenCircumstances",
                    "childrenVerifiedCircumstancesConversation",
                    "claimant",
                    "claimantAccessType",
                    "claimantAttachmentUpload",
                    "claimantCommitment",
                    "claimantCorporateAppointee",
                    "claimantEligibilityDetails",
                    "claimantEvent",
                    "claimantHistory",
                    "claimantIdentity",
                    "claimantIdentityVerification",
                    "claimantLanguagePreference",
                    "claimantNotification",
                    "claimantProfile",
                    "claimantSpareRoomSubsidyEligibility",
                    "claimantStats",
                    "claimantUploadDetails",
                    "claimantVerifyIdentity",
                    "claimHistoryEntry-archived",
                    "claimHistoryEntry-eight",
                    "claimHistoryEntry-eighteen",
                    "claimHistoryEntry-eleven",
                    "claimHistoryEntry-fifteen",
                    "claimHistoryEntry-five",
                    "claimHistoryEntry-four",
                    "claimHistoryEntry-fourteen",
                    "claimHistoryEntry-nine",
                    "claimHistoryEntry-nineteen",
                    "claimHistoryEntry-one",
                    "claimHistoryEntry-seven",
                    "claimHistoryEntry-seventeen",
                    "claimHistoryEntry-six",
                    "claimHistoryEntry-sixteen",
                    "claimHistoryEntry-ten",
                    "claimHistoryEntry-thirteen",
                    "claimHistoryEntry-thirty",
                    "claimHistoryEntry-thirtyone",
                    "claimHistoryEntry-thirtytwo",
                    "claimHistoryEntry-three",
                    "claimHistoryEntry-twelve",
                    "claimHistoryEntry-twenty",
                    "claimHistoryEntry-twentyeight",
                    "claimHistoryEntry-twentyfive",
                    "claimHistoryEntry-twentyfour",
                    "claimHistoryEntry-twentynine",
                    "claimHistoryEntry-twentyone",
                    "claimHistoryEntry-twentyseven",
                    "claimHistoryEntry-twentysix",
                    "claimHistoryEntry-twentythree",
                    "claimHistoryEntry-twentytwo",
                    "claimHistoryEntry-two",
                    "coldWeatherPayment",
                    "configuration",
                    "confirmBenefitsDetailsToDoTimestamp",
                    "contract",
                    "contractEvent",
                    "contractStats",
                    "controlMeasure",
                    "conversion-status",
                    "corporateAppointeeBody",
                    "corporateAppointeeBodyAddress",
                    "corporateAppointeeBodyBankDetails",
                    "corporateAppointeesTfaSmsTransactionMetadata",
                    "corporateAppointeeUserAccount",
                    "covid19ClaimSelectorLog",
                    "covid19DeductionsBypassLog",
                    "covid19PrepaymentBypassLog",
                    "covidAffected",
                    "covidAffectedToDo",
                    "cpsPaymentFileRecord",
                    "cyiClaimantRequest",
                    "cyiLoginToken",
                    "debtControlSheet",
                    "debtControlSheetToDoData",
                    "debtInterest",
                    "debtPosition",
                    "declaration",
                    "declarationOverrideInterval",
                    "deductionsStatus",
                    "deductionsStatusRequired",
                    "deferredConsiderClosingClaimDecision",
                    "delayedMessage",
                    "deliveryUnitAddress",
                    "deliveryUnitThirdPartyReference",
                    "depsAndNonDepsSpareRoomSubsidyEligibility",
                    "destinationStatistics",
                    "digimanData",
                    "digimanDataArchive",
                    "disclosure-archived",
                    "disclosureData-archived",
                    "disclosureData-eight",
                    "disclosureData-eighteen",
                    "disclosureData-eleven",
                    "disclosureData-fifteen",
                    "disclosureData-five",
                    "disclosureData-four",
                    "disclosureData-fourteen",
                    "disclosureData-nine",
                    "disclosureData-nineteen",
                    "disclosureData-one",
                    "disclosureData-seven",
                    "disclosureData-seventeen",
                    "disclosureData-six",
                    "disclosureData-sixteen",
                    "disclosureData-ten",
                    "disclosureData-thirteen",
                    "disclosureData-thirty",
                    "disclosureData-thirtyone",
                    "disclosureData-thirtytwo",
                    "disclosureData-three",
                    "disclosureData-twelve",
                    "disclosureData-twenty",
                    "disclosureData-twentyeight",
                    "disclosureData-twentyfive",
                    "disclosureData-twentyfour",
                    "disclosureData-twentynine",
                    "disclosureData-twentyone",
                    "disclosureData-twentyseven",
                    "disclosureData-twentysix",
                    "disclosureData-twentythree",
                    "disclosureData-twentytwo",
                    "disclosureData-two",
                    "disclosure-eight",
                    "disclosure-eighteen",
                    "disclosure-eleven",
                    "disclosure-fifteen",
                    "disclosure-five",
                    "disclosure-four",
                    "disclosure-fourteen",
                    "disclosure-nine",
                    "disclosure-nineteen",
                    "disclosure-one",
                    "disclosure-seven",
                    "disclosure-seventeen",
                    "disclosure-six",
                    "disclosure-sixteen",
                    "disclosure-ten",
                    "disclosure-thirteen",
                    "disclosure-thirty",
                    "disclosure-thirtyone",
                    "disclosure-thirtytwo",
                    "disclosure-three",
                    "disclosure-twelve",
                    "disclosure-twenty",
                    "disclosure-twentyeight",
                    "disclosure-twentyfive",
                    "disclosure-twentyfour",
                    "disclosure-twentynine",
                    "disclosure-twentyone",
                    "disclosure-twentyseven",
                    "disclosure-twentysix",
                    "disclosure-twentythree",
                    "disclosure-twentytwo",
                    "disclosure-two",
                    "earlyEstimatedCalculationParts",
                    "earlyStatement",
                    "earlyStatementContractId",
                    "earningsData",
                    "educationCircumstances",
                    "educationDeclaration",
                    "eligibilityCheckResponse",
                    "emailSearch",
                    "emailToClaimantMap",
                    "emailVerificationToken",
                    "employmentCircumstances",
                    "encryptedData",
                    "encryptedFileMetaData",
                    "endOfAssessmentPeriodProcessStatus",
                    "entitlementReason",
                    "estimatedCalculation",
                    "estimatedCalculationArchive",
                    "estimatedCalculationParts-archived",
                    "estimatedCalculationParts-eight",
                    "estimatedCalculationParts-eighteen",
                    "estimatedCalculationParts-eleven",
                    "estimatedCalculationParts-fifteen",
                    "estimatedCalculationParts-five",
                    "estimatedCalculationParts-four",
                    "estimatedCalculationParts-fourteen",
                    "estimatedCalculationParts-nine",
                    "estimatedCalculationParts-nineteen",
                    "estimatedCalculationParts-one",
                    "estimatedCalculationParts-seven",
                    "estimatedCalculationParts-seventeen",
                    "estimatedCalculationParts-six",
                    "estimatedCalculationParts-sixteen",
                    "estimatedCalculationParts-ten",
                    "estimatedCalculationParts-thirteen",
                    "estimatedCalculationParts-thirty",
                    "estimatedCalculationParts-thirtyone",
                    "estimatedCalculationParts-thirtytwo",
                    "estimatedCalculationParts-three",
                    "estimatedCalculationParts-twelve",
                    "estimatedCalculationParts-twenty",
                    "estimatedCalculationParts-twentyeight",
                    "estimatedCalculationParts-twentyfive",
                    "estimatedCalculationParts-twentyfour",
                    "estimatedCalculationParts-twentynine",
                    "estimatedCalculationParts-twentyone",
                    "estimatedCalculationParts-twentyseven",
                    "estimatedCalculationParts-twentysix",
                    "estimatedCalculationParts-twentythree",
                    "estimatedCalculationParts-twentytwo",
                    "estimatedCalculationParts-two",
                    "estimatedDeductions",
                    "expectedEvidenceDocuments",
                    "extractJob",
                    "extractSeqNo",
                    "failedKafkaMessages",
                    "failedMessage",
                    "failedMigrationEncryptedData",
                    "fasterPaymentStatus",
                    "featureConfiguration",
                    "featureToggles",
                    "financialHardshipStatus",
                    "firstCommitmentAppointmentsNotRequired",
                    "fraudPenalty",
                    "fraudPenaltyProgress",
                    "gender",
                    "genie",
                    "gracePeriod",
                    "guardiansAllowance",
                    "healthAndDisabilityCircumstances",
                    "healthAndDisabilityDeclaration",
                    "healthCircumstances",
                    "healthDeclaration",
                    "historicRteData",
                    "historicRteEarnings",
                    "hmrcChildDataProvision",
                    "holdingEncryptedData",
                    "holdingMigrated",
                    "housingCircumstances",
                    "housingDeclaration",
                    "housingEntitlement",
                    "hrtAppointmentRequired",
                    "idempotentNotificationMongoDocument",
                    "identityVerificationDetails",
                    "ineligiblePartner",
                    "insolvencyOrder",
                    "interaction",
                    "interestPerson",
                    "invalidUsernameIdentity",
                    "ipAddressConfidence",
                    "job",
                    "jobStatus",
                    "jounal",
                    "journal-archived",
                    "journal-eight",
                    "journal-eighteen",
                    "journal-eleven",
                    "journal-fifteen",
                    "journal-five",
                    "journal-four",
                    "journal-fourteen",
                    "journal-nine",
                    "journal-nineteen",
                    "journal-one",
                    "journal-seven",
                    "journal-seventeen",
                    "journal-six",
                    "journal-sixteen",
                    "journal-ten",
                    "journal-thirteen",
                    "journal-thirty",
                    "journal-thirtyone",
                    "journal-thirtytwo",
                    "journal-three",
                    "journal-twelve",
                    "journal-twenty",
                    "journal-twentyeight",
                    "journal-twentyfive",
                    "journal-twentyfour",
                    "journal-twentynine",
                    "journal-twentyone",
                    "journal-twentyseven",
                    "journal-twentysix",
                    "journal-twentythree",
                    "journal-twentytwo",
                    "journal-two",
                    "ladsNotificationDetail",
                    "landlordAddress",
                    "landlordPortalTenancy",
                    "landlordToDo",
                    "landlordToDoLock",
                    "languagePreference",
                    "languagePreferenceDeclaration",
                    "lastLogin",
                    "lastSavedPrepareCommitments",
                    "localUserMatchingData",
                    "login",
                    "managementInformation",
                    "manualAdvancePayment",
                    "manualAwardPayment",
                    "manualDeductionsCalculationData",
                    "manualOverride",
                    "matchingServiceRequests",
                    "moveToUc",
                    "moveToUcClaim",
                    "moveToUcRequest",
                    "nationalCostsRuleReferenceData",
                    "nationality",
                    "nationalityDeclaration",
                    "ninoCheck",
                    "nonLandlordApaRequest",
                    "nonStandardHousingAssessment",
                    "notificationSettings",
                    "notifyCisCache",
                    "notifyThirdPartyDeductionToDoData",
                    "onGoingInterest",
                    "onlyOnceMongoDocument",
                    "organisation",
                    "otherBenefit",
                    "otherBenefitAgentDeclaration",
                    "otherBenefitRelatedAction",
                    "otherBenefitsNotificationTimestamp",
                    "otherIncome",
                    "otherIncomeDeclaration",
                    "outOfClaimDays",
                    "overlappingBenefit",
                    "overpayment",
                    "partialDisclosure",
                    "partnerQuestion",
                    "partnerQuestionDeclaration",
                    "payment",
                    "paymentIC114827Backup",
                    "paymentKeys",
                    "paymentReference",
                    "pendingAdvanceData",
                    "pendingAuthorisationCache",
                    "pendingNotification",
                    "pendingStatement",
                    "periodOfSickness",
                    "persistedErrors",
                    "personalDetails",
                    "personDetails",
                    "pinChallenge",
                    "pinnedNote",
                    "pregnancy",
                    "pregnancyDeclaration",
                    "prepaymentCheckFailure",
                    "previousEarnings",
                    "properties",
                    "propertyAddress",
                    "propertyAddressListUpdate",
                    "proveYourIdentityTrial",
                    "provideTenancyDetailsRequest",
                    "qflowEnabledJobcentre",
                    "quartz",
                    "quartz_calendars",
                    "quartz_jobs",
                    "quartz_locks",
                    "quartz_paused_trigger_groups",
                    "quartz_schedulers",
                    "quartz_triggers",
                    "recalculateAgentStats",
                    "recoverableHardshipPayment",
                    "registrationTokenAllocation",
                    "relationshipDeclaration",
                    "reportSelfEmploymentEarningsFeedback",
                    "requiredAuthorisationEscalation",
                    "resolvedProperties-archived",
                    "resolvedProperties-eight",
                    "resolvedProperties-eighteen",
                    "resolvedProperties-eleven",
                    "resolvedProperties-fifteen",
                    "resolvedProperties-five",
                    "resolvedProperties-four",
                    "resolvedProperties-fourteen",
                    "resolvedProperties-nine",
                    "resolvedProperties-nineteen",
                    "resolvedProperties-one",
                    "resolvedProperties-seven",
                    "resolvedProperties-seventeen",
                    "resolvedProperties-six",
                    "resolvedProperties-sixteen",
                    "resolvedProperties-ten",
                    "resolvedProperties-thirteen",
                    "resolvedProperties-thirty",
                    "resolvedProperties-thirtyone",
                    "resolvedProperties-thirtytwo",
                    "resolvedProperties-three",
                    "resolvedProperties-twelve",
                    "resolvedProperties-twenty",
                    "resolvedProperties-twentyeight",
                    "resolvedProperties-twentyfive",
                    "resolvedProperties-twentyfour",
                    "resolvedProperties-twentynine",
                    "resolvedProperties-twentyone",
                    "resolvedProperties-twentyseven",
                    "resolvedProperties-twentysix",
                    "resolvedProperties-twentythree",
                    "resolvedProperties-twentytwo",
                    "resolvedProperties-two",
                    "rolePrivileges",
                    "rteInterestSet",
                    "rtiFeed",
                    "saltData",
                    "sanction",
                    "sanctionEscalation",
                    "sanctionProgress",
                    "sanctionTerminationDecision",
                    "savingsAndInvestmentDeclaration",
                    "selfEmploymentLoss",
                    "sentAppointmentReminder",
                    "session",
                    "sessionTraceable",
                    "srsLandlordBankDetails",
                    "srsRentChanges",
                    "stagedNotification",
                    "statement",
                    "statementAndComparison",
                    "stopTaxCreditNotice",
                    "storedPassword",
                    "summary",
                    "supportForMortgageInterest",
                    "supportMortgageInterestEligibilityDetails",
                    "supportMortgageInterestLoanAccepted",
                    "survey",
                    "suspiciousCalculation",
                    "systemWorkGroupAllocation",
                    "team",
                    "teamMemberStats",
                    "telephonyClaimApplication",
                    "telephonyClaimApplicationTransition",
                    "temp",
                    "temporaryAccess",
                    "tenancyAgreement",
                    "terminalIllness",
                    "testCollection",
                    "tfaDisabledLandlord",
                    "tfaLastSuccessfulAttempt",
                    "tfaSmsUser",
                    "thirdParty",
                    "thirdPartyAuthenticationTransactionMetadata",
                    "thirdPartyCreditor",
                    "thirdPartyDeduction",
                    "thirdPartyDeductionPriority",
                    "thirdPartyLandlordTransactionMetadata",
                    "thirdPartyUsersTransactionMetadata",
                    "threatLevel",
                    "toDo",
                    "traceable",
                    "trackedNotification",
                    "transactionResults",
                    "transitionalProtection",
                    "trialGroupParameters",
                    "trialParticipant",
                    "triggerHistory",
                    "untrustedIdentity",
                    "UpdateMongoLock_acceptedDataService",
                    "UpdateMongoLock_advances",
                    "UpdateMongoLock_agentAccessService",
                    "UpdateMongoLock_agentAttachment",
                    "UpdateMongoLock_agentCore",
                    "UpdateMongoLock_agentSession",
                    "UpdateMongoLock_appointments",
                    "UpdateMongoLock_authenticator",
                    "UpdateMongoLock_calculationProcess",
                    "UpdateMongoLock_calculator",
                    "UpdateMongoLock_childrenCore",
                    "UpdateMongoLock_claimantAdvances",
                    "UpdateMongoLock_claimantCommunicationService",
                    "UpdateMongoLock_claimantHistory",
                    "UpdateMongoLock_claimantSession",
                    "UpdateMongoLock_claimantTfaSms",
                    "UpdateMongoLock_coldWeatherPaymentsCore",
                    "UpdateMongoLock_core",
                    "UpdateMongoLock_corporateAppointeesCore",
                    "UpdateMongoLock_corporateAppointeesTfaSms",
                    "UpdateMongoLock_cryptoCore",
                    "UpdateMongoLock_cryptoOps",
                    "UpdateMongoLock_dataAcceptanceService",
                    "UpdateMongoLock_dataArchivingCore",
                    "UpdateMongoLock_deductions",
                    "UpdateMongoLock_deductionsProcess",
                    "UpdateMongoLock_hrtEntitlement",
                    "UpdateMongoLock_identity",
                    "UpdateMongoLock_laidPostcodeLookupCore",
                    "UpdateMongoLock_landlordTfaSms",
                    "UpdateMongoLock_matchingService",
                    "UpdateMongoLock_moveToUcCore",
                    "UpdateMongoLock_overpayments",
                    "UpdateMongoLock_paymentsCore",
                    "UpdateMongoLock_paymentsProcess",
                    "UpdateMongoLock_penaltiesAndDeductions",
                    "UpdateMongoLock_personalDetails",
                    "UpdateMongoLock_propertyAddressLookupCore",
                    "UpdateMongoLock_quartz",
                    "UpdateMongoLock_riskDataService",
                    "UpdateMongoLock_selfEmploymentClaimantCore",
                    "UpdateMongoLock_sessionConfidence",
                    "UpdateMongoLock_supportCore",
                    "UpdateMongoLock_systemCore",
                    "UpdateMongoLock_teamCore",
                    "UpdateMongoLock_thirdParties",
                    "UpdateMongoLock_thirdPartiesIntegration",
                    "UpdateMongoLock_thirdPartyAuthentication",
                    "UpdateMongoLock_thirdPartyLandlord",
                    "UpdateMongoLock_thirdPartySession",
                    "UpdateMongoLock_thirdPartyUsers",
                    "UpdateMongoLock_token",
                    "UpdateMongoLock_workCapabilityAssessment",
                    "UpdateMongoLock_workSearchCore",
                    "urlVisit",
                    "userAssociation",
                    "verifyIdentityAssessment",
                    "watchList",
                    "watchListMatches",
                    "wizard",
                    "workAndEarningsCircumstances",
                    "workAndEarningsDeclaration",
                    "workCapabilityAssessmentDecision",
                    "workCapabilityAssessmentDeclaration",
                    "workGroupAllocation",
                    "youthObligationDetails")

            val expected = setOf("accessCodeThrottle",
                    "accessCodeVerification",
                    "accessList",
                    "accountVerification",
                    "actionedPayments",
                    "activeAdvanceProcess",
                    "additionalClaimantInformation",
                    "address",
                    "addressDeclaration",
                    "advanceDebtPosition",
                    "advanceDetails",
                    "advanceGroup",
                    "advanceProcessInitialisationFailure",
                    "agent",
                    "agentAction",
                    "agentAssignment",
                    "agentFeedback",
                    "agentGuidance",
                    "agentGuidanceTracking",
                    "agentPrivileges",
                    "agentsInTeam",
                    "agentSupportRoles",
                    "agentTakenTime",
                    "agentThirdPartyReference",
                    "agentToDo",
                    "agentToDoArchive",
                    "agentToDoImport",
                    "agentWorkGroupAllocation",
                    "alternativePaymentArrangement",
                    "apa",
                    "apaPayment",
                    "appointment",
                    "appointmentReminderJobMetadata",
                    "appointmentTypesByJobcentre",
                    "archiveRecord",
                    "assessmentPeriod",
                    "attachmentMetaData",
                    "attachments",
                    "attachmentsData",
                    "attachmentsMetadata",
                    "authentication",
                    "authenticationRequest",
                    "availability",
                    "awardModification",
                    "bankAccountTransactionData",
                    "bankDetails",
                    "bankDetailsDeclaration",
                    "blockedTime",
                    "blockedTimeSlot",
                    "bookedEvidenceOrPsnAppointment",
                    "bulkRentChangeRequest",
                    "calculatedDeductions",
                    "calculateDeductions",
                    "calculation",
                    "calculationParts",
                    "calculatorClaim",
                    "capital",
                    "carerCircumstances",
                    "carerDeclaration",
                    "carersAllowance",
                    "carerTimeOff",
                    "caringDeclaration",
                    "caseLoadEvent",
                    "checkAutoCalcPendingData",
                    "childcare",
                    "childcareDeclaration",
                    "childcareTransactionData",
                    "childDeclaration",
                    "childElementEligibility",
                    "childrenCircumstances",
                    "childrenVerifiedCircumstancesConversation",
                    "claimant",
                    "claimantAccessType",
                    "claimantAttachmentUpload",
                    "claimantCommitment",
                    "claimantCorporateAppointee",
                    "claimantEligibilityDetails",
                    "claimantEvent",
                    "claimantHistory",
                    "claimantIdentity",
                    "claimantIdentityVerification",
                    "claimantLanguagePreference",
                    "claimantNotification",
                    "claimantProfile",
                    "claimantSpareRoomSubsidyEligibility",
                    "claimantStats",
                    "claimantUploadDetails",
                    "claimantVerifyIdentity",
                    "claimHistoryEntry",
                    "coldWeatherPayment",
                    "configuration",
                    "confirmBenefitsDetailsToDoTimestamp",
                    "contract",
                    "contractEvent",
                    "contractStats",
                    "controlMeasure",
                    "conversion-status",
                    "corporateAppointeeBody",
                    "corporateAppointeeBodyAddress",
                    "corporateAppointeeBodyBankDetails",
                    "corporateAppointeesTfaSmsTransactionMetadata",
                    "corporateAppointeeUserAccount",
                    "covid19ClaimSelectorLog",
                    "covid19DeductionsBypassLog",
                    "covid19PrepaymentBypassLog",
                    "covidAffected",
                    "covidAffectedToDo",
                    "cpsPaymentFileRecord",
                    "cyiClaimantRequest",
                    "cyiLoginToken",
                    "debtControlSheet",
                    "debtControlSheetToDoData",
                    "debtInterest",
                    "debtPosition",
                    "declaration",
                    "declarationOverrideInterval",
                    "deductionsStatus",
                    "deductionsStatusRequired",
                    "deferredConsiderClosingClaimDecision",
                    "delayedMessage",
                    "deliveryUnitAddress",
                    "deliveryUnitThirdPartyReference",
                    "depsAndNonDepsSpareRoomSubsidyEligibility",
                    "destinationStatistics",
                    "digimanData",
                    "digimanDataArchive",
                    "disclosure",
                    "disclosureData",
                    "earlyEstimatedCalculationParts",
                    "earlyStatement",
                    "earlyStatementContractId",
                    "earningsData",
                    "educationCircumstances",
                    "educationDeclaration",
                    "eligibilityCheckResponse",
                    "emailSearch",
                    "emailToClaimantMap",
                    "emailVerificationToken",
                    "employmentCircumstances",
                    "encryptedData",
                    "encryptedFileMetaData",
                    "endOfAssessmentPeriodProcessStatus",
                    "entitlementReason",
                    "estimatedCalculation",
                    "estimatedCalculationArchive",
                    "estimatedCalculationParts",
                    "estimatedDeductions",
                    "expectedEvidenceDocuments",
                    "extractJob",
                    "extractSeqNo",
                    "failedKafkaMessages",
                    "failedMessage",
                    "failedMigrationEncryptedData",
                    "fasterPaymentStatus",
                    "featureConfiguration",
                    "featureToggles",
                    "financialHardshipStatus",
                    "firstCommitmentAppointmentsNotRequired",
                    "fraudPenalty",
                    "fraudPenaltyProgress",
                    "gender",
                    "genie",
                    "gracePeriod",
                    "guardiansAllowance",
                    "healthAndDisabilityCircumstances",
                    "healthAndDisabilityDeclaration",
                    "healthCircumstances",
                    "healthDeclaration",
                    "historicRteData",
                    "historicRteEarnings",
                    "hmrcChildDataProvision",
                    "holdingEncryptedData",
                    "holdingMigrated",
                    "housingCircumstances",
                    "housingDeclaration",
                    "housingEntitlement",
                    "hrtAppointmentRequired",
                    "idempotentNotificationMongoDocument",
                    "identityVerificationDetails",
                    "ineligiblePartner",
                    "insolvencyOrder",
                    "interaction",
                    "interestPerson",
                    "invalidUsernameIdentity",
                    "ipAddressConfidence",
                    "job",
                    "jobStatus",
                    "jounal",
                    "journal",
                    "ladsNotificationDetail",
                    "landlordAddress",
                    "landlordPortalTenancy",
                    "landlordToDo",
                    "landlordToDoLock",
                    "languagePreference",
                    "languagePreferenceDeclaration",
                    "lastLogin",
                    "lastSavedPrepareCommitments",
                    "localUserMatchingData",
                    "login",
                    "managementInformation",
                    "manualAdvancePayment",
                    "manualAwardPayment",
                    "manualDeductionsCalculationData",
                    "manualOverride",
                    "matchingServiceRequests",
                    "moveToUc",
                    "moveToUcClaim",
                    "moveToUcRequest",
                    "nationalCostsRuleReferenceData",
                    "nationality",
                    "nationalityDeclaration",
                    "ninoCheck",
                    "nonLandlordApaRequest",
                    "nonStandardHousingAssessment",
                    "notificationSettings",
                    "notifyCisCache",
                    "notifyThirdPartyDeductionToDoData",
                    "onGoingInterest",
                    "onlyOnceMongoDocument",
                    "organisation",
                    "otherBenefit",
                    "otherBenefitAgentDeclaration",
                    "otherBenefitRelatedAction",
                    "otherBenefitsNotificationTimestamp",
                    "otherIncome",
                    "otherIncomeDeclaration",
                    "outOfClaimDays",
                    "overlappingBenefit",
                    "overpayment",
                    "partialDisclosure",
                    "partnerQuestion",
                    "partnerQuestionDeclaration",
                    "payment",
                    "paymentIC114827Backup",
                    "paymentKeys",
                    "paymentReference",
                    "pendingAdvanceData",
                    "pendingAuthorisationCache",
                    "pendingNotification",
                    "pendingStatement",
                    "periodOfSickness",
                    "persistedErrors",
                    "personalDetails",
                    "personDetails",
                    "pinChallenge",
                    "pinnedNote",
                    "pregnancy",
                    "pregnancyDeclaration",
                    "prepaymentCheckFailure",
                    "previousEarnings",
                    "properties",
                    "propertyAddress",
                    "propertyAddressListUpdate",
                    "proveYourIdentityTrial",
                    "provideTenancyDetailsRequest",
                    "qflowEnabledJobcentre",
                    "quartz",
                    "quartz_calendars",
                    "quartz_jobs",
                    "quartz_locks",
                    "quartz_paused_trigger_groups",
                    "quartz_schedulers",
                    "quartz_triggers",
                    "recalculateAgentStats",
                    "recoverableHardshipPayment",
                    "registrationTokenAllocation",
                    "relationshipDeclaration",
                    "reportSelfEmploymentEarningsFeedback",
                    "requiredAuthorisationEscalation",
                    "resolvedProperties",
                    "rolePrivileges",
                    "rteInterestSet",
                    "rtiFeed",
                    "saltData",
                    "sanction",
                    "sanctionEscalation",
                    "sanctionProgress",
                    "sanctionTerminationDecision",
                    "savingsAndInvestmentDeclaration",
                    "selfEmploymentLoss",
                    "sentAppointmentReminder",
                    "session",
                    "sessionTraceable",
                    "srsLandlordBankDetails",
                    "srsRentChanges",
                    "stagedNotification",
                    "statement",
                    "statementAndComparison",
                    "stopTaxCreditNotice",
                    "storedPassword",
                    "summary",
                    "supportForMortgageInterest",
                    "supportMortgageInterestEligibilityDetails",
                    "supportMortgageInterestLoanAccepted",
                    "survey",
                    "suspiciousCalculation",
                    "systemWorkGroupAllocation",
                    "team",
                    "teamMemberStats",
                    "telephonyClaimApplication",
                    "telephonyClaimApplicationTransition",
                    "temp",
                    "temporaryAccess",
                    "tenancyAgreement",
                    "terminalIllness",
                    "testCollection",
                    "tfaDisabledLandlord",
                    "tfaLastSuccessfulAttempt",
                    "tfaSmsUser",
                    "thirdParty",
                    "thirdPartyAuthenticationTransactionMetadata",
                    "thirdPartyCreditor",
                    "thirdPartyDeduction",
                    "thirdPartyDeductionPriority",
                    "thirdPartyLandlordTransactionMetadata",
                    "thirdPartyUsersTransactionMetadata",
                    "threatLevel",
                    "toDo",
                    "traceable",
                    "trackedNotification",
                    "transactionResults",
                    "transitionalProtection",
                    "trialGroupParameters",
                    "trialParticipant",
                    "triggerHistory",
                    "untrustedIdentity",
                    "UpdateMongoLock_acceptedDataService",
                    "UpdateMongoLock_advances",
                    "UpdateMongoLock_agentAccessService",
                    "UpdateMongoLock_agentAttachment",
                    "UpdateMongoLock_agentCore",
                    "UpdateMongoLock_agentSession",
                    "UpdateMongoLock_appointments",
                    "UpdateMongoLock_authenticator",
                    "UpdateMongoLock_calculationProcess",
                    "UpdateMongoLock_calculator",
                    "UpdateMongoLock_childrenCore",
                    "UpdateMongoLock_claimantAdvances",
                    "UpdateMongoLock_claimantCommunicationService",
                    "UpdateMongoLock_claimantHistory",
                    "UpdateMongoLock_claimantSession",
                    "UpdateMongoLock_claimantTfaSms",
                    "UpdateMongoLock_coldWeatherPaymentsCore",
                    "UpdateMongoLock_core",
                    "UpdateMongoLock_corporateAppointeesCore",
                    "UpdateMongoLock_corporateAppointeesTfaSms",
                    "UpdateMongoLock_cryptoCore",
                    "UpdateMongoLock_cryptoOps",
                    "UpdateMongoLock_dataAcceptanceService",
                    "UpdateMongoLock_dataArchivingCore",
                    "UpdateMongoLock_deductions",
                    "UpdateMongoLock_deductionsProcess",
                    "UpdateMongoLock_hrtEntitlement",
                    "UpdateMongoLock_identity",
                    "UpdateMongoLock_laidPostcodeLookupCore",
                    "UpdateMongoLock_landlordTfaSms",
                    "UpdateMongoLock_matchingService",
                    "UpdateMongoLock_moveToUcCore",
                    "UpdateMongoLock_overpayments",
                    "UpdateMongoLock_paymentsCore",
                    "UpdateMongoLock_paymentsProcess",
                    "UpdateMongoLock_penaltiesAndDeductions",
                    "UpdateMongoLock_personalDetails",
                    "UpdateMongoLock_propertyAddressLookupCore",
                    "UpdateMongoLock_quartz",
                    "UpdateMongoLock_riskDataService",
                    "UpdateMongoLock_selfEmploymentClaimantCore",
                    "UpdateMongoLock_sessionConfidence",
                    "UpdateMongoLock_supportCore",
                    "UpdateMongoLock_systemCore",
                    "UpdateMongoLock_teamCore",
                    "UpdateMongoLock_thirdParties",
                    "UpdateMongoLock_thirdPartiesIntegration",
                    "UpdateMongoLock_thirdPartyAuthentication",
                    "UpdateMongoLock_thirdPartyLandlord",
                    "UpdateMongoLock_thirdPartySession",
                    "UpdateMongoLock_thirdPartyUsers",
                    "UpdateMongoLock_token",
                    "UpdateMongoLock_workCapabilityAssessment",
                    "UpdateMongoLock_workSearchCore",
                    "urlVisit",
                    "userAssociation",
                    "verifyIdentityAssessment",
                    "watchList",
                    "watchListMatches",
                    "wizard",
                    "workAndEarningsCircumstances",
                    "workAndEarningsDeclaration",
                    "workCapabilityAssessmentDecision",
                    "workCapabilityAssessmentDeclaration",
                    "workGroupAllocation",
                    "youthObligationDetails")

            val ucRecordReader = UcRecordReader()

            val coalesced = dumplist.map {
                ucRecordReader.coalesced(it)
            }.toSet()

            coalesced shouldBe expected
        }

        "fun agentCoreAgentToDoArchiveIsCoalesced()" {
            val ucRecordReader = UcRecordReader()
            val actual = ucRecordReader.coalescedArchive("agent_core:agentToDoArchive")
            actual shouldBe "agent_core:agentToDo"
        }

        "fun otherDbAgentToDoArchiveIsNotCoalesced()" {
            val ucRecordReader = UcRecordReader()
            val actual = ucRecordReader.coalescedArchive("other_db:agentToDoArchive")
            actual shouldBe "other_db:agentToDoArchive"
        }


        "fun otherCollectionIsNotCoalesced()" {
            val ucRecordReader = UcRecordReader()
            val actual = ucRecordReader.coalescedArchive("core:calculationParts")
            actual shouldBe "core:calculationParts"
        }
    }
}
